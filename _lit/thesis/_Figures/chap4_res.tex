%!TEX TS-program = xelatex
%!TeX spellcheck = en_GB

% Load the required package using class
\documentclass[tikz,class=article]{standalone}

%\usepackage{tikz}
\usetikzlibrary{spy,fit,matrix,shapes.callouts,calc,trees,positioning,arrows,chains,shapes.geometric,shapes.multipart,arrows.meta,  decorations.pathreplacing,decorations.text,decorations.pathmorphing,decorations.markings,shapes,matrix,shapes.symbols,patterns,datavisualization,datavisualization.formats.functions,angles,backgrounds,pgfplots.groupplots}


\usepackage{contour,pgfplots}                    % for outlining text
\usepackage{fontspec}
              
    
\usepackage{fontawesome}                          % web fonts

    
    % Monospaced font
    \setmonofont{LibertinusMono-Regular.otf}[
                 Scale=0.8,
                 Path            = ./_Fonts/,
                 Extension       = .otf,
                ]                
    
    % Main text font
    \setmainfont{LibertinusSerif}[%
                 Ligatures       = {Common}, %Numbers={OldStyle}, Variant=01,
                 Path            = ./_Fonts/,
                 Extension       = .otf,
                 UprightFont     = *-Regular,
                 BoldFont        = *-Bold,
                 ItalicFont      = *-Italic,
                 BoldItalicFont  = *-BoldItalic,
                ]
    % Sanserif font
    \setsansfont{LibertinusSans}[
                 Path            = ./_Fonts/,
                 Extension       = .otf,
                 UprightFont     = *-Regular,
                 BoldFont        = *-Bold,
                 ItalicFont      = *-Italic,
                ]
    



\usepackage{mathtools}                            % extension to amsmath which loads it automatically
\usepackage{amsthm}                               % math theorems
\usepackage{mathrsfs}
%\usepackage{amssymb}                             % symbols like \square  (always before unicode-math)
\usepackage{xfrac}                                % slanted fractions 
\usepackage{accents}
%\usepackage[bb=mma,cal=cm,scr=esstix]{mathalfa}
\usepackage{unicode-math}                        % Math for XeLaTeX
\usepackage{stackrel}                             % Enhancements to the \stackrel command


\unimathsetup{math-style=ISO, bold-style=ISO}




    % Math font setting
    \setmathfont{LibertinusMath-Regular}[             % General math font
                 Path            = ./_Fonts/,
                 Extension       = .otf
                 ]
    
    % Requires lm-math package
    \setmathfont{Latin Modern Math}[                  % Calligraphy font for linear operators
                 range           = {cal, bfcal},
                 ]
    
    % Requires tex-gyre-math package
    \setmathfont{TeX Gyre Termes Math}[               % For proper blackboard letters
                 range=bb
                 ]
    
    \setmathfont{XITSMath-Regular}[               % For fraktur
                 Path            = ./_Fonts/,
                 Extension       = .otf,
                 range           = frak,
                 ]
    
    \setmathfont{XITSMath-Bold}[               % For fraktur
                 Path            = ./_Fonts/,
                 Extension       = .otf,
                 range           = bffrak,
                 ]
    
    
    \setmathfont{LibertinusMath-Regular}[             % For upright Greek letters using \mup...
                 Path            = ./_Fonts/,
                 Extension       = .otf,
                 range           = up/{greek,Greek},          
                 math-style      = literal
                 ]
    
    


\newcommand{\code}[1]{\texttt{#1}}






% Packages and macros
%\input{./_Style/MyStyle}

	% Settings
%	\pgfplotsset{compat=newest}


%	\pgfdeclarelayer{background}
%	\pgfsetlayers{background}
%	\pgfsetlayers{background,main,foreground} 



% Flowchart styles
  \tikzset{
   %% Define styles for structural symbols
    %simple node
    snode/.style = {draw,thick,circle, text height = 0.2cm, text width= 0.2cm,inner sep=0, minimum size = 2mm },
    % elements
    myelement/.style = {draw,ultra thick},
    % point load
    pload/.style   = {draw, text width=2cm, rectangle, thick},
    %% Define styles for flowchart symbols
    % basic style
    fbase/.style = {draw, fill=lightgray, inner sep=1mm, semithick},
    % Node label style (plain text)
    nlabel/.style = {label=left:{\small#1}},
    % Process style (Rectangle)
    fproc/.style = {fbase, rectangle,text width=0.75cm},
    % I/O style (Parallelogram)
    fio/.style = {fbase, trapezium, trapezium right angle=120, trapezium left angle=60,text width=0.75cm},
    % Flowchart Connection style (arrows)
    fconc/.style = {thick, draw,-stealth,label={"#1"}},
    % Simple Connection style (lines)
    sconc/.style = {thick, draw,label={"#1"}},
    % Terminal style (ellipse)
    fterm/.style = {fbase, ellipse, inner sep=0.5mm},
    % Decision style (diamond)
    fdeci/.style = {fbase, diamond, inner sep=0mm, minimum size=0.3cm},
    % Extra info bracket style (bracket)
    fbrac/.style = {decorate, decoration={brace}, thick},
    % Intrinsic subprogram style (Splited rectangle)
    fsubin/.style = {fbase,rectangle split, rectangle split parts=3, rectangle split horizontal,semithick,rectangle split empty part width=0.1cm, inner xsep=0.05cm, inner ysep=1mm},
    % External/internal subprogram (Splited rectangle from top)
    fsubex/.style = {fbase, inner sep=0,rectangle split,rectangle split every empty part={},rectangle split empty part height=0cm,rectangle split empty part width=0ex, rectangle split empty part depth=0cm,,rectangle split parts=2, semithick,text height=-0.3cm},
    % Callout style (comments)
    mycallout/.style = {draw,pattern=north west lines, pattern color=lightgray!75, semithick, rectangle callout, inner sep=2mm,align=justify,callout absolute pointer={#1},text width=4cm},
    % Junction style (small circles)
    fjunc/.style = {fbase, circle, inner sep=0mm,text width=1mm,,minimum size=2mm},
    % Off-page connector style (Trapezoid)
    fnext/.style = {fbase, inner xsep=1mm,inner ysep=0.5mm,chamfered rectangle,chamfered rectangle ysep=0.5cm,chamfered rectangle xsep=0.5cm,chamfered rectangle corners={south west,south east},text width=2mm},
    % Matrix style but outside of a matrix
    matrixoutstyle/.style ={draw,line width=0.75pt, anchor=center,fill=gray!50, text centered, rounded corners=0.1cm, minimum width=1cm, minimum height=5mm, minimum width=0.2cm,inner sep=1mm, font=\scriptsize},
    % General Matrix style
    matrixstyle/.style={matrix of nodes, nodes={matrixoutstyle},row sep=0.4cm, column sep=1cm, minimum width=0.2cm,inner sep=0, font=\scriptsize},
    % General tikzstyle
    mytikzstyle/.style={node distance=0.5cm,anchor=center,font=\scriptsize},
    % Pseudocode style
    pcstyle/.style={node distance=-0.15cm},
    % Flowchart style
    fcstyle/.style={row sep=0cm,column sep=0cm,minimum width=1mm,align=center},
    % Flowchart blank node
    fblanku/.style={yshift=0.4cm},
    fblankd/.style={yshift=-0.4cm},
    % To put a node between two others
    between/.style args={#1 and #2}{at = ($(#1)!0.5!(#2)$)}
  }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
	\pgfplotsset{set layers=standard}
	
	
% replace to add frame (it does not work with fillinbetween)
%\begin{tikzpicture}[tdplot_main_coords,framed]

	
% replace to add frame (it does not work with fillinbetween)
%\begin{tikzpicture}[tdplot_main_coords,framed]
\begin{tikzpicture}%[tdplot_main_coords]





\begin{axis}
[%semithick,
	name = topaxis, anchor=north,
width = 12cm,
height = 8cm,
xlabel = {Nominal/True fibre volume fraction (\%), $\zeta_\text{N}$ or $\zeta_\text{T}$},
xmin = 0.0,
xmax = 12.0,
%y label style={yshift=0.2cm},
y tick label style={
	/pgf/number format/.cd,
		fixed,
		fixed zerofill,
		precision=3,
	},
	legend cell align=left,
%point meta=explicit symbolic,
ylabel =  {Apparent thermal conductivity ($\sfrac{\text{W}}{\text{m}\cdot\text{K}}$), $k$},
%ymax = 0.2500, 
%extra y ticks={0.214},
%ymin = 0,
%ytick pos=left,
%legend entries= {{0.1},{0.2},{0.3},{0.4}},
legend pos=north west,% south,
%legend style={at={(0.5,-0.15)},anchor=north},
%cycle list name=black white,
%legend style={font=\small}
smooth,
%axis y discontinuity=parallel,
]
% ══════════════════════════════════════════════════════════════════════════════════════════════════

	% if an empty line in the legend is required
	%\addlegendimage{empty legend};


	% horizontal line
%	\addplot[samples=10, thick, domain=0:5,densely dotted] {0.21513};

	% Trend line of discrete data
%	\addplot[domain=0.6:4]
%	{0.0007*x^6 - 0.01*x^5 + 0.0617*x^4 - 0.1942*x^3 + 0.3304*x^2 - 0.2898*x^ + 0.3205};


% Nominal z-axis
\addplot
[mark=*, dashed, %only marks,
mark options={black,fill=gray!50,draw},
mark size=2.5pt,
error bars/.cd,
y dir=both,
y explicit,
error bar style={black, line width=0.5pt},
error mark options={rotate=90, blue, mark size=1pt, line width=0.5pt}
] table [
 x index=0, 
 y index=1,
 x expr=\thisrowno{0}*100,
% ,y error index=2
 ] 
 {./_data_ch4/nominal_z.tex};

% True z-axis
\addplot
[mark=*, %only marks,
mark options={black,fill=black,draw},
mark size=2.5pt,
error bars/.cd,
y dir=both,
y explicit,
error bar style={black, line width=0.5pt},
error mark options={rotate=90, blue, mark size=1pt, line width=0.5pt}
] table [
 x index=0, 
 y index=1,
 x expr=\thisrowno{0}*100,
% ,y error index=2
 ] 
 {./_data_ch4/true_z.tex};

% Nominal rand
\addplot
[mark=triangle*, dashed, %only marks,
mark options={black,fill=gray!50,draw},
mark size=3pt,
error bars/.cd,
y dir=both,
y explicit,
error bar style={black, line width=0.5pt},
error mark options={rotate=90, blue, mark size=1pt, line width=0.5pt}
] table [
 x index=0, 
 y index=1,
 x expr=\thisrowno{0}*100,
% ,y error index=2
 ] 
 {./_data_ch4/nominal_rand.tex};

% True rand
\addplot
[mark=triangle*, %only marks,
mark options={black,fill=black,draw},
mark size=3pt,
error bars/.cd,
y dir=both,
y explicit,
error bar style={black, line width=0.5pt},
error mark options={rotate=90, blue, mark size=1pt, line width=0.5pt}
] table [
 x index=0, 
 y index=1,
 x expr=\thisrowno{0}*100,
% ,y error index=2
 ] 
 {./_data_ch4/true_rand.tex};
 
 
% \begin{groupplot}[
%     group style={
%         group name=my fancy plots,
%         group size=1 by 2,
%         xticklabels at=edge bottom,
%         vertical sep=0pt
%     },
%     width=8.5cm,
%     xmin=-6, xmax=6
% ]
% 
% \nextgroupplot[ymin=45,ymax=80,
%                ytick={60,80},
%                axis x line=top, 
%                axis y discontinuity=parallel,
%                height=4.5cm]
 
 
% Nominal y-axis
\addplot
[mark=square*, dashed, %only marks,
mark options={black,fill=gray!50,draw},
mark size=2.5pt,
error bars/.cd,
y dir=both,
y explicit,
error bar style={black, line width=0.5pt},
error mark options={rotate=90, blue, mark size=1pt, line width=0.5pt}
] table [
 x index=0, 
 y index=1,
 x expr=\thisrowno{0}*100,
% ,y error index=2
 ] 
 {./_data_ch4/nominal_y.tex};
 
% True y-axis
\addplot
[mark=square*, %only marks,
mark options={black,fill=black,draw},
mark size=2.5pt,
error bars/.cd,
y dir=both,
y explicit,
error bar style={black, line width=0.5pt},
error mark options={rotate=90, blue, mark size=1pt, line width=0.5pt}
] table [
 x index=0, 
 y index=1,
 x expr=\thisrowno{0}*100,
% ,y error index=2
 ] 
 {./_data_ch4/true_y.tex};
 

 
% \node at (3,0.21513) {0.21513};
% \draw[Stealth-] (axis cs: 3,0.216) -- +(0.5,10) node [above] {\small $\text{Percentage relative Error}\le 0.05\%$};
 
%
 
 
%% computational+
%\addplot
%[mark=square*, mark options ={fill= black}, 
% mark size=1.5pt,
%error bars/.cd,
%y dir=both,
%y explicit,
% error bar style={black, line width=1pt},
% error mark options={rotate=90, black, mark size=3pt, line width=1.pt}
%] table [
% x index=0, 
% y index=1
% ,y error index=2
% ] 
% {./data/failstress_strength_updating.tex};
% 
%% computational -
%\addplot
%[mark=square*, mark options ={fill= white},
%mark size=2pt,
%error bars/.cd,
%	y dir=both,
%	y explicit,
% error bar style={black, line width=1pt},
% error mark options={rotate=90, black, mark size=3pt, line width=1.pt}
%] table [
% x index=0, 
% y index=1, 
% y error index=2
% ] 
% {./data/failstress_strength_not_updating.tex};
%
%
%\addplot
%[name path=kellyc,
%mark=diamond*,
%	mark options={fill=white},
%	no marks, dashed,very thick,
%mark size=\the\marksize,
%error bars/.cd,
%y dir=both,
%y explicit,
%error bar style={black, line width=0.5pt},
%error mark options={rotate=90, black, mark size=1pt, line width=0.5pt}
%] table [
% x index=0, 
% y index=1
%% ,y error index=2
% ] 
% {./data/failstress_kelly_classic.tex};
%
%\addplot
%[name path=kellyen, dashdotted,very thick,
%mark=diamond*,
%	mark options={fill=white},
%	no marks, 
%mark size=\the\marksize,
%error bars/.cd,
%y dir=both,
%y explicit,
%error bar style={black, line width=0.5pt},
%error mark options={rotate=90, black, mark size=1pt, line width=0.5pt}
%] table [
% x index=0, 
% y index=1
%% ,y error index=2
% ] 
% {./data/failstress_kelly_en.tex};
%\addplot[name path=rom, densely dashed,
%	mark=diamond*, no marks,
%	mark options={fill=gray},
%	mark size=\the\marksize,
%	error bars/.cd,
%	y dir=both,======
%	y explicit,
%	error bar style={black, line width=0.5pt},
%	error mark options={rotate=90, black, mark size=1pt, line width=0.5pt}
%	] table [
%	 x index=0, 
%	 y index=1
%	% ,y error index=2
%	 ] 
%	 {./data/E_rom.tex};
% plot 5 
%	\addplot[name path=enrom,no marks, densely dotted] table [x index=0, y index=1] 
%	{./data/E_enrom.tex};
	 

%	\addplot[opacity=0.1, blue!50] fill between [of=kellyen and kellyc]; 
%	\addplot[opacity=0.3, blue!50] fill between [of=rom and enrom]; 


	 
% Legends
	% if an empty line is needed
	%  \addlegendentry{\hspace{-0.7cm}\ };
  \addlegendentry{\footnotesize $\quad\zeta_\text{N}$, aligned along $Z$-axis\hfill};
  \addlegendentry{\footnotesize $\quad\zeta_\text{T}$, aligned along $Z$-axis\hfill};
  \addlegendentry{\footnotesize $\quad\zeta_\text{N}$, randomly oriented\hfill};
  \addlegendentry{\footnotesize $\quad\zeta_\text{T}$, randomly oriented\hfill};
  \addlegendentry{\footnotesize $\quad\zeta_\text{N}$, aligned along $Y$-axis\hfill};
  \addlegendentry{\footnotesize $\quad\zeta_\text{T}$, aligned along $Y$-axis\hfill};
  

  
  
  
%  \addlegendentry{RoM};
%  \addlegendentry{En-RoM};
%  \addlegendentry{Classic IRom-RoM};
%  \addlegendentry{Extention by En-Rom};
\end{axis}






\end{tikzpicture}

\end{document}